if has('win32') || has('win64')
    " Make windows use ~/.vim too, I don't want to use _vimfiles
    set runtimepath^=~/.vim
endif

set path+=include
set path+=src
set path+=../include
set path+=../src
set path+=../../include
set path+=../../src
set path+=../../../include
set path+=../../../src

syntax on

" Disable BCE to make colorschemes work on tmux
set t_ut=
if &diff
    colorscheme zenburn
else
    colorscheme fu
endif

set scrollopt+=hor

set tabstop=4 shiftwidth=4 softtabstop=4
set expandtab
set list listchars=tab:\|-,trail:~,extends:>,precedes:<
set smarttab
set smartindent
set wrap
set bs=indent,eol,start
set nocompatible
set foldmethod=syntax
set foldlevelstart=99
set scrolloff=50
set ignorecase


" default to relative line numbers
set relativenumber
set nonumber
set numberwidth=5

" show absolute line numbers when focus is lost
au FocusLost *   :set nu | set nornu
au FocusGained * :set rnu | set nonu

" show absolute line numbers when in insert mode
au InsertEnter * :set nu | set nornu
au InsertLeave * :set rnu | set nonu

" navigating with arrow keys in normal mode is a no-no
nnoremap <Up> <NOP>
nnoremap <Down> <NOP>
nnoremap <Left> <NOP>
nnoremap <Right> <NOP>

" try to stick to normal mode for navigating
inoremap <Up> <NOP>
inoremap <Down> <NOP>
inoremap <Left> <NOP>
inoremap <Right> <NOP>

"map <C-W> :qa!<Enter>

set laststatus=2
set statusline=%n)\ %f%m%r%h%w\ (%{&ff},%{&fenc}){%Y}\ [%l,%v]%=[%p%%,%L\ lines]

" Highlight current cursor line
set cul
hi CursorLine term=bold cterm=bold

"inoremap <Tab> <C-V><Tab>
au BufNewFile,BufReadPre *.mk setlocal noexpandtab
au BufNewFile,BufReadPre Makefile* setlocal noexpandtab

" Use all utf-8 for encoding a file.
scriptencoding utf-8
set fileencodings=utf-8,utf-16le,utf-16be
set encoding=utf-8

if !&diff
    set colorcolumn=81
    hi ColorColumn ctermbg=236 guibg=#444444
endif

" Window swapping
function! MarkWindowSwap()
    let g:markedWinNum = winnr()
endfunction

function! DoWindowSwap()
    "Mark destination
    let curNum = winnr()
    let curBuf = bufnr( "%" )
    exe g:markedWinNum . "wincmd w"
    "Switch to source and shuffle dest->source
    let markedBuf = bufnr( "%" )
    "Hide and open so that we aren't prompted and keep history
    exe 'hide buf' curBuf
    "Switch to dest and shuffle source->dest
    exe curNum . "wincmd w"
    "Hide and open so that we aren't prompted and keep history
    exe 'hide buf' markedBuf 
endfunction

map <F2> :NERDTreeToggle<CR>

nmap <S-F5> :tabp<CR>
nmap <S-F6> :tabn<CR>
nmap <F5> <C-w>W
nmap <F6> <C-w>w

nmap <silent> <leader>mw :call MarkWindowSwap()<CR>
nmap <silent> <leader>pw :call DoWindowSwap()<CR>

"set diffopt+=iwhite
"set diffexpr=PatientDiff()
"function PatientDiff()
"    let opt = ""
"    if &diffopt =~ "icase"
"        let opt = opt . "-i "
"    endif
"    if &diffopt =~ "iwhite"
"        let opt = opt . "-w " " swapped vim's -b with -w
"    endif
"    silent execute "!diff -a " . opt .
"        \ v:fname_in . " " . v:fname_new .  " > " . v:fname_out
"endfunction

execute pathogen#infect('pathogens/{}')

